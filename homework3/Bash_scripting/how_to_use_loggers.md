# Bash scripting
## Анализ логов nginx с помощью bash
### logger.sh
Позиционным параметром скрипту передается полный путь до файла(включая сам файл)
Файл с отчетом по логам создается в текущей директории под названием report .
### Описание команд
1. num_requests=`cat $path | grep ' - - ' | wc -l | tr -s ' ' | cut -f2 -d ' '`
выводим access.log с помощью команды cat, отбираем запрос по символам ' - - ', считаем количество вхождений этих символов, форматируем вывод команды wc.
2. num\_requests\_by_method=`cat $path | cut -f6 -d ' ' | sort | uniq -c | tr -d '"'  `
выводим access.log с помощью команды cat, отбираем 6 столбец с методом запроса, сортируем по методам и считаем количество повторяющихся методов, форматируем вывод команды.
3. top\_size\_requests=`cat $path | sort -k10 -n -r| cut -f1,4,5,6,7,10 -d ' ' | head | tr -d '"'  `
выводим access.log с помощью команды cat, сортируем по 10 столбцу(размеру) в обратном порядке, выбираем необходимые столбцы, отбираем первые 10 запросов, форматируем вывод команды.
4. top\_requests\_client_error=`cat $path | awk '$9 ~ /^4/ {print $1, $6, $7, $9 }' | sort  | uniq -c| sort -r -n | head | tr -d '"' `
выводим файл, отбираем зпросы по 9 столбцу(статус ответа) с первой цифрой 4, сортируем выбранные запросы, считаем одинаковые, сортируем в обратном порядке, отбираем первые 10, форматируем вывод команды.
5. top\_requests\_redirect=`cat $path | awk '$9 ~ /^3/ {print $1, $6, $7, $9 }' | sort  | uniq -c| sort -r -n | head | tr -d '"' `
выводим файл, отбираем запросы по 9 столбцу(статус ответа) с первой цифрой 5, сортируем выбранные запросы, считаем одинаковые, сортируем в обратном порядке, отбираем первые 10, форматируем вывод команды.

### report
отчет по логам в формате, делиметр - пустая строка:

* 1 строка - количество запросов 
* следущие строки количество запросов каждого типа 
* следующие строк - 10 самых больших запросов в формате `ip-адрес время_запроса метод url размер` 
* следуюшие 10 строк - топ запросов с клиентской ошибкой в формате `количество ip-адрес метод url статус_ответа`
* следуюшие 10 строк - топ запросов с редиректом в формате `количество ip-адрес метод url статус_ответа`



## Анализ логов с помощью python
### logger_.py
Параметром скрипту передается полный путь каталога в формате .../.../directorya/ or ..../.../directorya . Если скрипту не передан никакой аргумент, то файлы *.log ищутся в текущей директории. Для каждого файла с логами создается отчет в текущей директории в формате :
`{названия файла с логами}_report` , 
`{названия файла с логами}_report.json`

### report.py
Отчет по логам в формате, (делиметр- ##########) :

* 1 строка - количество запросов 
* следущая строки количество запросов каждого типа 
* следующие 10 строк - 10 самых больших запросов в формате `url ip-адрес метод время` 
* следуюшие 10 строк - топ запросов с клиентской ошибкой в формате `url ip-адрес статус_ответа количество`
* следуюшие 10 строк - топ запросов с редиректом в формате `url ip-адрес статус_ответа количество`

### report.json
Отчет по логам в формате - лист со всеми данными:

* 1 словарь - {"count" : количество запросов} 
* словарь - количество запросов каждого типа {
  "POST": количество post,
  "GET": количество get, ...}
* лист с 10 словарями - 10 самых больших запросов 
* лист с 10 словарями - топ запросов с клиентской ошибкой  
* лист с 10 словарями - топ запросов с редиректом  


